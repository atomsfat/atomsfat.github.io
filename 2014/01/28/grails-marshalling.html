<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv='X-UA-Compatible' content='IE=edge;chrome=1' />
    <title>Atomsfat techblog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Tomás Salazar">


    <!-- Le styles -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }
    </style>
    <link href="/assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
    <link rel="shortcut icon" href="../assets/ico/favicon.png">
  </head>
</head>
<body>

  <div class="container-fluid">
    <div class="row-fluid">
      <div class="span3">
        <div class="well sidebar-nav">
          <div class="pagination-centered">
            <img src="https://1.gravatar.com/avatar/f732e5a8b77f8e4ed8fadc2c71916236.jpg">
          </div>
          <h5 class="text-center"><a href="/">TECHBLOG</a></h5>
          <h5 class="text-center">by <a href="https://twitter.com/atomsfat">atomsfat</a></h5>
          <ul class="nav nav-list">
            <li class="nav-header">Articulos recientes</li>
            
              <li><a href="/2014/01/28/grails-marshalling.html">Grails JSON Marshalling bien hecho.</a></li>
            
              <li><a href="/2013/08/21/hacer-un-backup-de-mysql-a-amazon-s3.html">Hacer un backup de mysql a Amazon S3</a></li>
            
              <li><a href="/2013/08/21/subir-archivos-a-amazon-s3-con-groovy.html">Subir archivos a Amazon S3 con Groovy</a></li>
            
              <li><a href="/2008/12/26/apache-webproxy-y-tunnelling.html">Apache WebProxy, y tunnelling</a></li>
            
              <li><a href="/2008/11/11/java-decompiler.html">Java Decompiler</a></li>
            
              <li><a href="/2008/11/11/java-obfuscator.html">Java Obfuscator</a></li>
            
            <li class="nav-header">Etiquetas</li>
            
              <li><a href="/tags/java.html">Java (2)</a> </a></li>
          
              <li><a href="/tags/groovy.html">Groovy (3)</a> </a></li>
          
              <li><a href="/tags/amazon.html">Amazon (2)</a> </a></li>
          
              <li><a href="/tags/s3.html">S3 (2)</a> </a></li>
          
              <li><a href="/tags/mysql.html">MySql (1)</a> </a></li>
          
              <li><a href="/tags/grails.html">Grails (1)</a> </a></li>
          
          <li class="nav-header">Por año</li>
          
            <li><a href="/2014.html">2014 (1)</a> </a></li>
        
            <li><a href="/2013.html">2013 (2)</a> </a></li>
        
            <li><a href="/2008.html">2008 (3)</a> </a></li>
        
      </ul>
    </div><!--/.well -->
  </div><!--/span-->
  <div class="span9">
      <h1 id="personalizar-marshaller-json-en-grails">Personalizar marshaller JSON en Grails</h1>

<p>El personalizado de marshallers esta bastante documentado:</p>

<ul>
  <li><a title="title" href="http://kylewbanks.com/blog/Customizing-JSON-Grails-Object-Marshalling">Customizing JSON Output in Grails with JSON Object Marshaller</a>.</li>
</ul>

<p>Básicamente consiste en los siguientes pasos:</p>

<ol>
  <li>Creamos un marshaller para la clase (mapa con los valores que deseamos regresar)</li>
  <li>Se registra el marshaller en el <strong>BootStrap.groovy</strong>.</li>
</ol>

<p>Definir un marshaller para una clase en el <strong>BootStrap.groovy</strong>, no se esta tan mal, pero que si necesitamos definir todo el dominio
de una aplicación.</p>

<p>Una posible solución:</p>

<p><a title="title" href="http://compiledammit.com/2012/08/16/custom-json-marshalling-in-grails-done-right/">Custom JSON Marshalling in Grails, Done “Right”</a> </p>

<p>En este blog crean los marshaller en archivos separados, luego en un mapa definen los beans, y en con la ayuda del spring inyectan y 
registran. </p>

<p>Lo cual parece demasiado. </p>

<p>Mi propuesta:</p>

<ol>
  <li>Engordar la clase de dominio para que contenga su propio marshaller.</li>
  <li>Si la clase de dominio define un marshaller, que de manera automática se registre en <strong>BootStrap.groovy</strong>.</li>
</ol>

<p>Clase gorda con marshaller:</p>

<script src="https://gist.github.com/atomsfat/8673440.js"></script>

<p>Escaneo de las clases de dominio:</p>

<script src="https://gist.github.com/atomsfat/8673594.js"></script>

<p>Conclusiones:</p>

<ul>
  <li>Creo que esta solución es correcta por que no es necesario modificar el <strong>BootStrap.groovy</strong> cada vez que necesitamos un marshaller.</li>
  <li>Si se requiere un cambio es muy fácil modificar la clase de dominio.</li>
</ul>


  </div>
</div>

<hr>

<footer>
  <p>&copy; Tomás Salazar Leal 2014</p>
</footer>

    </div><!--/.fluid-container-->

  </body>
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-6535072-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</html>
